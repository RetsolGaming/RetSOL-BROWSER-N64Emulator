<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RetSOL N64 v3.0</title>
    <style>
        body { background-color: #050505; color: #00e0ff; font-family: 'Courier New', monospace; text-align: center; margin: 0; }
        #screen-container { width: 100vw; max-height: 60vh; background: black; box-shadow: 0 0 30px #00e0ff; border-bottom: 2px solid #00e0ff; }
        #canvas { width: 100%; height: auto; display: block; }
        .menu { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 20px; }
        button { padding: 18px; border: 2px solid; font-weight: bold; background: rgba(0,0,0,0.6); color: inherit; font-size: 12px; text-transform: uppercase; }
        .btn-load { border-color: #00e0ff; grid-column: span 2; box-shadow: 0 0 15px #00e0ff; }
        .btn-save { border-color: #bc00ff; box-shadow: 0 0 15px #bc00ff; }
        .btn-hub { border-color: #ff00ff; grid-column: span 2; }
        #status { font-size: 11px; color: #00e0ff; margin-top: 10px; letter-spacing: 2px; }
    </style>
</head>
<body>
    <div id="screen-container"><canvas id="canvas"></canvas></div>
    <div id="status">RETSOL N64 READY...</div>
    <div class="menu">
        <button class="btn-load" onclick="vibrate(); loadN64Rom()">üéÆ LOAD N64 GAME (.Z64)</button>
        <button class="btn-save" onclick="vibrate(); quickSaveN64()">üíæ QUICK SAVE</button>
        <button class="btn-save" onclick="vibrate(); quickLoadN64()">üìÇ QUICK LOAD</button>
        <button class="btn-hub" onclick="location.href='https://RetsolGaming.github.io/RetSOL-Hub/'">üè† BACK TO HUB</button>
    </div>
    <script src="https://cdn.jsdelivr.net/gh/kb-elmo/n64wasm@master/dist/n64wasm.js"></script>
    <script>
        function vibrate() { if (navigator.vibrate) navigator.vibrate(40); }
        async function loadN64Rom() {
            const input = document.createElement('input');
            input.type = 'file';
            input.onchange = async e => {
                const file = e.target.files[0];
                const buffer = await file.arrayBuffer();
                window.n64wasm.loadRom(new Uint8Array(buffer));
                document.getElementById('status').innerText = "RUNNING: " + file.name;
            };
            input.click();
        }
        function quickSaveN64() {
            const state = window.n64wasm.saveState();
            localStorage.setItem('n64_save', btoa(String.fromCharCode(...state)));
            document.getElementById('status').innerText = "SAVED TO MEMORY";
        }
        function quickLoadN64() {
            const data = localStorage.getItem('n64_save');
            if (data) {
                const state = Uint8Array.from(atob(data), c => c.charCodeAt(0));
                window.n64wasm.loadState(state);
                document.getElementById('status').innerText = "LOADED FROM MEMORY";
            }
        }
    </script>
</body>
</html>
